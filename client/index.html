<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collaborative Drawing Canvas</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <h1 class="logo">üé® Collaborative Canvas</h1>
                <div class="header-badge">
                    <span class="live-indicator"></span>
                    <span>Live Collaboration</span>
                </div>
            </div>
            <div class="user-info">
                <div class="user-count-badge">
                    <span class="user-icon">üë•</span>
                    <span id="userCount">0 users online</span>
                </div>
                <div id="userId" class="user-id-badge"></div>
            </div>
        </header>

        <div class="main-content">
            <!-- Left Sidebar - Tools Panel -->
            <div class="sidebar">
                <div class="tools-panel">
                    <h3>üõ†Ô∏è Drawing Tools</h3>
                    
                    <div class="tool-group">
                        <label>Tools:</label>
                        <div class="tools">
                            <button id="brushTool" class="tool active" data-tool="brush" title="Brush Tool (B)">
                                üñåÔ∏è Brush
                            </button>
                            <button id="eraserTool" class="tool" data-tool="eraser" title="Eraser Tool (E)">
                                üßΩ Eraser
                            </button>
                            <button id="rectangleTool" class="tool" data-tool="rectangle" title="Rectangle (R)">
                                ‚¨ú Rectangle
                            </button>
                            <button id="circleTool" class="tool" data-tool="circle" title="Circle (C)">
                                ‚≠ï Circle
                            </button>
                            <button id="lineTool" class="tool" data-tool="line" title="Line (L)">
                                ‚ûñ Line
                            </button>
                            <button id="textTool" class="tool" data-tool="text" title="Text (T)">
                                üìù Text
                            </button>
                        </div>
                    </div>
                    
                    <!-- Text Input (hidden until text tool is selected) -->
                    <div class="tool-group" id="textInputGroup" style="display: none;">
                        <label for="textInput">Text:</label>
                        <input type="text" id="textInput" placeholder="Type text here..." maxlength="50">
                        <button id="applyText" class="tool">Apply Text</button>
                    </div>

                    <div class="tool-group">
                        <label for="colorPicker">Color:</label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="colorPicker" value="#000000" title="Select drawing color">
                            <div class="color-preview" id="colorPreview"></div>
                            <span class="color-hex" id="colorHex">#000000</span>
                        </div>
                    </div>

                    <div class="tool-group">
                        <label for="brushSize">Brush Size: <span id="brushSizeValue" class="size-badge">5px</span></label>
                        <div class="slider-wrapper">
                            <input type="range" id="brushSize" min="1" max="50" value="5" title="Adjust brush size (1-9 keys)">
                            <div class="slider-track"></div>
                        </div>
                        <div class="size-preview" id="sizePreview"></div>
                    </div>

                    <div class="tool-group">
                        <label>Actions:</label>
                        <div class="actions">
                            <button id="undoBtn" class="tool" title="Undo (Ctrl+Z)">
                                ‚Ü©Ô∏è Undo
                            </button>
                            <button id="redoBtn" class="tool" title="Redo (Ctrl+Y)">
                                ‚Ü™Ô∏è Redo
                            </button>
                            <button id="clearCanvas" class="tool danger" title="Clear entire canvas">
                                üóëÔ∏è Clear
                            </button>
                        </div>
                    </div>
                    
                    <div class="tool-group">
                        <label>Persistence:</label>
                        <div class="actions">
                            <button id="saveCanvas" class="tool" title="Save current drawing">
                                üíæ Save
                            </button>
                            <button id="loadCanvas" class="tool" title="Load saved drawing">
                                üìÇ Load
                            </button>
                            <input type="file" id="imageUpload" accept="image/*" style="display: none;">
                            <button id="uploadImage" class="tool" title="Upload image to canvas">
                                üñºÔ∏è Image
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Rooms Panel -->
                <div class="users-panel">
                    <h3>üè† Rooms</h3>
                    <div class="room-controls">
                        <input type="text" id="roomNameInput" placeholder="Room name..." maxlength="20">
                        <button id="createRoom" class="tool">Create</button>
                        <button id="joinRoom" class="tool">Join</button>
                    </div>
                    <div id="roomsList" class="users-list">
                        <div class="room-item active" data-room="default">
                            <span>üè† Default Room</span>
                            <span class="room-users">0</span>
                        </div>
                    </div>
                    
                    <h3 style="margin-top: 20px;">üë• Online Users</h3>
                    <div id="usersList" class="users-list">
                        <!-- Users will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Main Drawing Area -->
            <div class="drawing-area">
                <div class="canvas-container" id="canvasContainer">
                    <canvas id="drawingCanvas"></canvas>
                    <canvas id="cursorCanvas"></canvas>
                    
                    <!-- Drawing Instructions -->
                    <div class="drawing-instructions" id="instructions">
                        <div class="instruction-header">
                            <span>üí° Quick Tips</span>
                            <button class="close-instructions" id="closeInstructions">√ó</button>
                        </div>
                        <div class="instruction-item">üñ±Ô∏è Click and drag to draw</div>
                        <div class="instruction-item">üë• See others draw in real-time</div>
                        <div class="instruction-item">‚å®Ô∏è B=Brush, E=Eraser, 1-9=Size</div>
                        <div class="instruction-item">üé® Use color swatches for quick selection</div>
                    </div>
                    
                    <!-- Drawing Stats -->
                    <div class="drawing-stats" id="drawingStats">
                        <div class="stat-item">
                            <span class="stat-label">Strokes:</span>
                            <span class="stat-value" id="strokeCount">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Active:</span>
                            <span class="stat-value" id="activeStrokes">0</span>
                        </div>
                    </div>
                    
                    <!-- Performance Metrics -->
                    <div class="performance-metrics" id="performanceMetrics">
                        <div class="metric-item">
                            <span class="metric-label">FPS:</span>
                            <span class="metric-value" id="fpsCounter">60</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Latency:</span>
                            <span class="metric-value" id="latencyDisplay">0ms</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Room:</span>
                            <span class="metric-value" id="currentRoom">default</span>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions Bar -->
                <div class="quick-actions">
                    <button id="quickBrush" class="quick-action active" data-tool="brush" title="Brush">
                        üñåÔ∏è
                    </button>
                    <button id="quickEraser" class="quick-action" data-tool="eraser" title="Eraser">
                        üßΩ
                    </button>
                    <div class="color-swatches">
                        <div class="color-swatch" style="background-color: #000000;" data-color="#000000" title="Black"></div>
                        <div class="color-swatch" style="background-color: #ff0000;" data-color="#ff0000" title="Red"></div>
                        <div class="color-swatch" style="background-color: #0000ff;" data-color="#0000ff" title="Blue"></div>
                        <div class="color-swatch" style="background-color: #00ff00;" data-color="#00ff00" title="Green"></div>
                        <div class="color-swatch" style="background-color: #ffff00;" data-color="#ffff00" title="Yellow"></div>
                        <div class="color-swatch" style="background-color: #ff00ff;" data-color="#ff00ff" title="Magenta"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Connection Status -->
        <div id="connectionStatus" class="connection-status hidden">
            Connecting...
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="config.js"></script>
    <script src="main.js"></script>
    <script src="canvas.js"></script>
    <script src="websocket.js"></script>
</body>
</html>